<!DOCTYPE HTML>
	<head>
		<title>FV Extender 3</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<script type="text/javascript" src="../js/jquery.js"></script>
		<script type="text/javascript" src="../js/blog.js"></script>
		<link href="../css/background.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript">
			var bgp = chrome.extension.getBackgroundPage();
		
		
			$(document).ready( function() {
				$('#akn-update-and-blog-btn').click( _aknUpdateAndBlogBtnClicked );
				$('#akn-update-btn').click( _aknUpdateBtnClicked );			
				
				check_for_blog_updates();
				
				
				chrome.extension.sendRequest( { "action" : "init_accept_options" }, function( response ) {
					if ( response.action == 'init_accept_options' ) {
					
						$('#return-gift-msg').val( response[ "return-gift-msg" ] );
						$('#disable-sound').attr('checked', response[ "disable-sound" ] );
						$('#disable-looping').attr('checked', response[ "disable-looping" ] );
						$('#auto-accept-friend-requests').attr( 'checked', response[ "auto-accept-friend-requests" ] );
						$('#ignore-user-messages').attr( 'checked', response[ "ignore-user-messages" ] );
					}
				});
				
				chrome.extension.sendRequest( { action: "get_version" }, function( current_version ) {
					var rnd = Math.round( ( Math.random() * 1000 ) + 1 );			
					
					var date = new Date();
					date = new Date( date.getFullYear(), date.getMonth(), date.getDate(),0,0,0,0);
					$("#stats_iframe").attr( "src", "http://a-creative.github.com/FV-extender/stats.html?current_version=" + current_version + '&date=' + date.getTime() + '&key=' + rnd );
				} );
			});			
			
			function start( accept_mode ) {				
				chrome.extension.sendRequest( {
					"action" : "start_accept",
					"accept_mode" : accept_mode,
					"return-gift-msg" : $('#return-gift-msg').val(),
					"disable-sound" : $('#disable-sound:checked').val(),
					"disable-looping" : $('#disable-looping:checked').val(),
					"auto-accept-friend-requests" : $('#auto-accept-friend-requests:checked').val(),
					"ignore-user-messages" : $('#ignore-user-messages:checked').val(),
				}, function() {
					document.location.replace( 'accept_all_status.html' );	
				})
			}	
			
			function advanced() {
				jQuery('.site').html('<div class="wnd-loading" style="width:300px;height:20px;margin-top:-30px;margin-left:-150px">Loading advanced options. Please wait...</div>');
				
				chrome.extension.sendRequest( { 
					"action" : "resize_me",
					"height" : 315,
					"width"  : 528
				}, function() {
					document.location.replace( 'accept_all_options_adv.html' );	
				})
			}
		</script>
	</head>
	<body>
		<audio id="show-blog-update-snd" preload="preload" src="/sound/info.ogg"></audio>
		<div class="site">
			<h1>Accept requests - Options</h1>
			<div class="field wide">
				<div class="label">Message for when you return gifts:</div>
				<div class="input"><textarea id="return-gift-msg" rows="3"></textarea></div>	
			</div>
			
			<div class="field checkbox">				
				<div class="input"><input type="checkbox" id="disable-sound" /></div>
				<div class="label">Disable sounds</div>	
			</div>
			<div class="field checkbox">				
				<div class="input"><input type="checkbox" id="disable-looping" /></div>	
				<div class="label">Don't return gift when receiving a "Thank you" gift(recommended).</div>
			</div>
			<div class="field checkbox">				
				<div class="input"><input type="checkbox" id="auto-accept-friend-requests" /></div>	
				<div class="label">Automatically accept neighbor requests(recommended)</div>
			</div>
			<div class="field checkbox">				
				<div class="input"><input type="checkbox" id="ignore-user-messages" /></div>	
				<div class="label">Ignore user message when processing a request</div>
			</div>
			<div class="field submit">
				<div class="buttons">
					<!--<div class="button"><a href="#" onclick="advanced();return false" title="Accept requests(fast)">Advanced</a></div>-->
					<div class="button"><a href="#" onclick="start( 'JUST_HELP' );return false" title="Just help">Just help</a></div>
					
					<div class="button"><a href="#" onclick="start( 'ACCEPT' );return false" title="Accept requests(fast)">Accept</a></div>
					<div class="button"><a href="#" onclick="start( 'ACCEPT_AND_RETURN' );return false" title="Accept and return gifts(slow and experimental)">Accept & return</a></div>
				</div>
			</div>
			<div class="field beta-notice">
				FVE Extender 4 beta is now ready to try out.<br />
				<a href="http://www.a-creative.dk/#post_1" target="_blank">Read more and download</a>				
			</div>
			<div id="blog-updates-pop-down" class="blog-updates-pop-down">
				<div class="headline">FV Extender 4 beta news:<br /></div>
				<div class="left-content">
					<div class="posts"></div>
					<div class="read-more">
						<a href="http://a-creative.dk/" target="_blank">Read more</a> and <a href="http://a-creative.dk/download" target="_blank">download</a> when you feel ready!
					</div>
				</div>
				<br clear="all" />
			</div>
			<iframe id="stats_iframe" width="1" marginwidth="0" height="1" marginheight="0" scrolling="No" frameborder="0" hspace="0" vspace="0"></iframe>
		</div>
	</body>
</html>