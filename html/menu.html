<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="../css/menu.css">			
	</head>
	<body>
		<div class="menu" id="menu">			
			<a href="#" id="process-btn">Process requests</a>
			<a href="#" id="just-help-btn">Just help</a>
			<a href="#" id="abort-btn">Abort processing</a>
			<a href="#" id="settings-btn" class="enabled">Settings</a>
			<a href="#" id="app-settings-btn" class="enabled">App. Settings</a>
			<a href="http://a-creative.dk" class="enabled" target="_blank" title="Read about all FVE versions">FVE blog</a>
			<a href="#" id="donate-btn" class="enabled">Donate</a>
			<a href="#" id="updates-btn">- Checking FVE version...</a>
			<a id="update-sign" title="Click to read more about the new version">New FVE version available</a>
		</div>
		<script>
			
			var bgp = chrome.extension.getBackgroundPage();
			
			bgp.Version.checkForUpdates( function( update ) {
				
				var update_link = document.getElementById( 'updates-btn' );
			
				if ( update ) {
					
					if ( update.manual_update ) {
						update_link.target = '_blank';
						update_link.innerHTML = 'Update FVE'
						update_link.title = 'Click to read more about and update FVE to the latest version: ' + update.version ;
						
					} else {
						update_link.innerHTML = 'Update FVE now'
						
						update_link.title = 'Click to update FVE instantly to the latest version: ' + update.version;
					}
					
					update_link.target = '_blank';
					update_link.href = update.url;
					update_link.className = 'enabled';
					
					var sign = document.getElementById( 'update-sign' );
					sign.href = update.url;
					sign.target = '_blank';
					sign.style.display = 'block';
					
				} else {
					update_link.innerHTML = '- FVE is up-to-date';
				}
				
				
			} );
			
			function _abort_clicked() {
				bgp.main_tab_id = -1;
				bgp.processing = false;
				alert( 'Processing is aborted when the current request is done being processed.');
				window.close();
				return false;
			}
			
			function _process_clicked() {
				
				this.innerHTML = 'Loading requests...';
				this.onclick = function() {
					return false;
				};
				bgp.Proc.ProcessRequests( -1, function() {
					window.close();					
				} );
				
				return false;	
			}
			
			function _settings_clicked() {
				
				bgp.Tabs.openTab( { url: "html/settings.html" } );
				window.close();
				return false;
				
			}
			
			function _app_settings_clicked() {
				bgp.openTab( { url: "https://www.facebook.com/settings?tab=applications" } );
				window.close();
				return false;
			}
			
			function _just_help_btn_clicked() {
				alert( 'Feature not available yet. Just help will be added in a later version.' );
				/*
				bgp.processing = true;
				bgp.just_help = true;
				bgp.goto_requests();
				*/
				window.close();
			
				return false;
				
			}
			
			function _donate_btn_clicked() {
				bgp.openTab( { url: "http://a-creative.dk/donate/" } );
				window.close();
				return false;
			}
			
			var abort_btn = document.getElementById( 'abort-btn' );
			var process_btn = document.getElementById( 'process-btn' );
			var settings_btn = document.getElementById( 'settings-btn' );
			var app_settings_btn = document.getElementById( 'app-settings-btn' );
			var just_help_btn = document.getElementById( 'just-help-btn' );
			var donate_btn = document.getElementById( 'donate-btn' );
			
			if ( bgp.processing ) {
				abort_btn.className = 'enabled';
				abort_btn.onclick = _abort_clicked;
				
			} else {
				process_btn.className = 'enabled';
				process_btn.onclick = _process_clicked;
			}
			
			settings_btn.onclick = _settings_clicked;
			app_settings_btn.onclick = _app_settings_clicked;
			just_help_btn.onclick = _just_help_btn_clicked;
			donate_btn.onclick = _donate_btn_clicked;
			
			
			
			
		</script>	
	</body>
</html>